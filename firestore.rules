rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // colección pública de proyectos (lectura pública)
    match /projects/{projectId} {
      allow read: if true;

      // Escrituras permitidas en producción solo para usuarios con custom claim admin == true
      // Para desarrollo puedes añadir tu uid aquí (reemplaza 'DEV_UID') o usar una claim 'debug' temporal.
      // IMPORTANTE: elimina la condición de DEV_UID antes de publicar en producción.
      allow write: if request.auth != null &&
                   (request.auth.token.admin == true
                    // Excepción de desarrollo — sustituye por tu uid y quítala luego
                    || request.auth.uid == 'DEV_UID'
                    // alternativo: || request.auth.token.debug == true
                   );
    }

    // por defecto negar otros accesos
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
